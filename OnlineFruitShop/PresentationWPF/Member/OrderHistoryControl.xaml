<UserControl x:Class="PresentationWPF.Member.OrderHistoryControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:PresentationWPF.Member"
             Background="#F8F9FA">

    <UserControl.Resources>
        <!-- Cancel Button Visibility Style -->
        <Style x:Key="CancelButtonVisibilityStyle" TargetType="Button" BasedOn="{StaticResource PrimaryButtonStyle}">
            <Setter Property="Background" Value="#E74C3C"/>
            <Setter Property="Content" Value="🚫 Hủy"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="FontSize" Value="12"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Status}" Value="Canceled">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Delivered">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <StackPanel Margin="40">
            <!-- Page Header -->
            <TextBlock Text="📦 Lịch sử đơn hàng" Style="{StaticResource PageHeaderStyle}"/>

            <!-- Orders Content -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel>
                    <TextBlock Text="Danh sách đơn hàng của bạn" Style="{StaticResource SectionHeaderStyle}"/>

                    <!-- Orders DataGrid -->
                    <DataGrid x:Name="dgOrders"
                              Style="{StaticResource ModernDataGridStyle}"
                              ColumnHeaderStyle="{StaticResource DataGridHeaderStyle}"
                              MinHeight="400">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Mã đơn" Binding="{Binding OrderId}" Width="80"/>
                            <DataGridTextColumn Header="Ngày đặt" Binding="{Binding OrderDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Tổng tiền (₫)" Width="150">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Text" Value="{Binding TotalAmount, StringFormat={}{0:N0}}"/>
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                        <Setter Property="Foreground" Value="#E74C3C"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTemplateColumn Header="Trạng thái" Width="120">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border CornerRadius="12" Padding="8,4" HorizontalAlignment="Center">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Status}" Value="Confirmed">
                                                            <Setter Property="Background" Value="#3498db"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Status}" Value="Delivered">
                                                            <Setter Property="Background" Value="#27ae60"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Status}" Value="Canceled">
                                                            <Setter Property="Background" Value="#E74C3C"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <TextBlock Text="{Binding Status}"
                                                       Foreground="White"
                                                       FontWeight="SemiBold"
                                                       FontSize="12"
                                                       HorizontalAlignment="Center"/>
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="Người nhận" Binding="{Binding ReceiverName}" Width="*"/>
                            <DataGridTextColumn Header="SĐT" Binding="{Binding ReceiverPhone}" Width="120"/>
                            <DataGridTextColumn Header="Địa chỉ" Binding="{Binding ShippingAddress}" Width="200"/>

                            <!-- Action Column -->
                            <DataGridTemplateColumn Header="Thao tác" Width="200">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="👁️ Xem"
                                                    Style="{StaticResource SecondaryButtonStyle}"
                                                    Padding="8,4"
                                                    FontSize="12"
                                                    Margin="0,0,5,0"
                                                    Click="ViewOrder_Click"
                                                    ToolTip="Xem chi tiết đơn hàng"/>
                                            <Button Style="{StaticResource CancelButtonVisibilityStyle}"
                                                    Click="CancelOrder_Click"
                                                    ToolTip="Hủy đơn hàng"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
